<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Test - TechPortal</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: #0a0a0a; 
            color: white; 
            padding: 20px; 
        }
        .test-section {
            background: #1a1a1a;
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            background: #2a2a2a;
            border-radius: 5px;
        }
        .success { background: #2d5a2d; }
        .error { background: #5a2d2d; }
    </style>
</head>
<body>
    <h1>üîß Debug Test - TechPortal</h1>
    
    <div class="test-section">
        <h2>1. JavaScript Modules Test</h2>
        <button class="test-button" onclick="testModules()">Test Modules</button>
        <div id="modulesResult" class="test-result"></div>
    </div>
    
    <div class="test-section">
        <h2>2. Security Functions Test</h2>
        <button class="test-button" onclick="testSecurity()">Test Security</button>
        <div id="securityResult" class="test-result"></div>
    </div>
    
    <div class="test-section">
        <h2>3. Widget Elements Test</h2>
        <button class="test-button" onclick="testWidgetElements()">Test Widget Elements</button>
        <div id="widgetResult" class="test-result"></div>
    </div>
    
    <div class="test-section">
        <h2>4. Portfolio Test</h2>
        <button class="test-button" onclick="testPortfolio()">Test Portfolio</button>
        <div id="portfolioResult" class="test-result"></div>
    </div>

    <!-- Include all modules -->
    <script src="js/core/security.js"></script>
    <script src="js/utils/api.js"></script>
    <script src="js/core/navigation.js"></script>
    <script src="js/components/forms.js"></script>
    <script src="js/components/portfolio.js"></script>
    <script src="js/components/chat.js"></script>
    <script src="js/components/calculator.js"></script>
    <script src="js/effects/animations.js"></script>
    <script src="js/effects/particles.js"></script>
    <script src="js/app.js"></script>

    <script>
        function testModules() {
            const result = document.getElementById('modulesResult');
            const modules = [
                'SecurityModule',
                'ApiModule', 
                'NavigationModule',
                'FormsModule',
                'PortfolioModule',
                'ChatModule',
                'CalculatorModule',
                'AnimationsModule',
                'ParticlesModule'
            ];
            
            const missing = [];
            const available = [];
            
            modules.forEach(module => {
                if (window[module]) {
                    available.push(module);
                } else {
                    missing.push(module);
                }
            });
            
            result.innerHTML = `
                <div class="success">Available modules: ${available.join(', ')}</div>
                ${missing.length > 0 ? `<div class="error">Missing modules: ${missing.join(', ')}</div>` : ''}
                <div>Total: ${available.length}/${modules.length} modules loaded</div>
            `;
            
            result.className = missing.length === 0 ? 'test-result success' : 'test-result error';
        }
        
        function testSecurity() {
            const result = document.getElementById('securityResult');
            
            const tests = [
                { name: 'secureGetElementById', func: () => typeof window.secureGetElementById === 'function' },
                { name: 'secureQuerySelector', func: () => typeof window.secureQuerySelector === 'function' },
                { name: 'secureQuerySelectorAll', func: () => typeof window.secureQuerySelectorAll === 'function' },
                { name: 'SecurityModule.sanitizeHTML', func: () => window.SecurityModule && typeof window.SecurityModule.sanitizeHTML === 'function' }
            ];
            
            const results = tests.map(test => ({
                name: test.name,
                passed: test.func()
            }));
            
            const passed = results.filter(r => r.passed).length;
            
            result.innerHTML = `
                ${results.map(r => `<div class="${r.passed ? 'success' : 'error'}">${r.name}: ${r.passed ? '‚úÖ' : '‚ùå'}</div>`).join('')}
                <div>Security tests: ${passed}/${tests.length} passed</div>
            `;
            
            result.className = passed === tests.length ? 'test-result success' : 'test-result error';
        }
        
        function testWidgetElements() {
            const result = document.getElementById('widgetResult');
            
            // Create temporary widget elements for testing
            const testHTML = `
                <div id="chatToggle" style="display:none;">Chat</div>
                <div id="chatWindow" style="display:none;">
                    <div id="chatMessages"></div>
                    <input id="chatInput" />
                    <button id="chatSend">Send</button>
                </div>
                <div id="calculatorToggle" style="display:none;">Calculator</div>
                <div id="calculatorWindow" style="display:none;"></div>
            `;
            
            // Add to body temporarily
            const testContainer = document.createElement('div');
            testContainer.innerHTML = testHTML;
            document.body.appendChild(testContainer);
            
            const elements = [
                'chatToggle',
                'chatWindow', 
                'chatMessages',
                'chatInput',
                'chatSend',
                'calculatorToggle',
                'calculatorWindow'
            ];
            
            const found = [];
            const missing = [];
            
            elements.forEach(id => {
                if (window.secureGetElementById && window.secureGetElementById(id)) {
                    found.push(id);
                } else {
                    missing.push(id);
                }
            });
            
            result.innerHTML = `
                <div class="success">Found elements: ${found.join(', ')}</div>
                ${missing.length > 0 ? `<div class="error">Missing elements: ${missing.join(', ')}</div>` : ''}
                <div>Elements: ${found.length}/${elements.length} found</div>
            `;
            
            result.className = missing.length === 0 ? 'test-result success' : 'test-result error';
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(testContainer);
            }, 100);
        }
        
        function testPortfolio() {
            const result = document.getElementById('portfolioResult');
            
            const tests = [
                { name: 'openModal function', func: () => typeof window.openModal === 'function' },
                { name: 'closeModal function', func: () => typeof window.closeModal === 'function' },
                { name: 'PortfolioModule exists', func: () => window.PortfolioModule !== undefined },
                { name: 'PortfolioModule.openProjectModal', func: () => window.PortfolioModule && typeof window.PortfolioModule.openProjectModal === 'function' }
            ];
            
            const results = tests.map(test => ({
                name: test.name,
                passed: test.func()
            }));
            
            const passed = results.filter(r => r.passed).length;
            
            result.innerHTML = `
                ${results.map(r => `<div class="${r.passed ? 'success' : 'error'}">${r.name}: ${r.passed ? '‚úÖ' : '‚ùå'}</div>`).join('')}
                <div>Portfolio tests: ${passed}/${tests.length} passed</div>
            `;
            
            result.className = passed === tests.length ? 'test-result success' : 'test-result error';
        }
        
        // Auto-run tests after modules load
        setTimeout(() => {
            console.log('üîß Running automatic debug tests...');
            testModules();
            testSecurity();
            testWidgetElements();
            testPortfolio();
        }, 2000);
    </script>
</body>
</html> 